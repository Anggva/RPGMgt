<!DOCTYPE html>
<html>
	<head>
		<link rel='stylesheet' type='text/css' href='style.css'>
		<script scr='build/jquery-1.11.2'></script>
		<script src='build/JSXTransformer.js'></script>
		<script src='build/react.js'></script>
		<script type='text/jsx'>

/** @jsx React.DOM */

var World = React.createClass({
	getDefaultProps: function() {
		return {
			rootMap: {
				mapName: 'TESTMAP',
				mapInfo: '',
				imageSrc: 'testImage.jpg',
				gotoLocEnabled: true,
				editingEnabled: false,
				childMaps: []
			}
		};
	},
	addNewMap: function() {
		this.props.currentMap.gotoLocEnabled = false;
		// prompt for new map info, followed by prompting for location
			// May have to change the event listener and restructure this, but the goal
			// is to have the user pick a location and size on the map to create the new map 
		var newLoc = {
				parentNode: this.props.currentMap
			};
			this.props.currentMap.children.push(newLoc);
			this.props.currentMap.gotoLocEnabled = true;
			this.props.currentMap = newLoc;
	},
	render: function() {
		this.props.currentMap = this.props.currentMap || this.props.rootMap;
		return(
			<div className='container'>
				<div className='container' id='mapImageContainer'>
					<MapImage mapNode={this.props.currentMap} parent={this} />
				</div>
				<div className='container' id='sidebarContainer'>
					<Sidebar mapNode={this.props.currentMap} parent={this} />
				</div>
			</div>
		);
	}
});

var MapImage = React.createClass({
	gotoLoc: function(newNode) {
		if(!this.props.mapNode.gotoLocEnabled)
			return;
		this.props.parent.props.currentMap = newNode;
	},
	render: function() {
		return(
			<div className='container' id='mapFrame'>
				<div className='container' id='map'>
					<img id='mapImage' src={this.props.mapNode.imageSrc} />
					{this.props.mapNode.childMaps.map(function(childMap){
						return <div className='mapLoc' onclick='gotoLoc(childMap)' style=
							'left: childMap.loc.X, top: childMap.loc.Y,
							width: childMap.loc.size, height: childMap.loc.size'
						/>;
					})}
				</div>
			</div>
		);
	}
});

var Sidebar = React.createClass({
	render: function() {
		return(
			<div className='container' id='sidebar'>
				<div id='title'><div id='t'>
					<h1>{this.props.mapNode.mapName}</h1>
				</div></div>
				<div id='mapInfo'>
					<p>{this.props.mapNode.mapInfo}</p>
				</div>
				<div id='options'>
				</div>
				<div id='bottomBar'></div>
			</div>
		);
	}
});


React.render(<World />, document.body);

		</script>
	</head>
	<body ondragstart='return false;' ondrop='return false;' />
</html>